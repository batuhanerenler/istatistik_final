# -------------------------------------------------------------------------- ###
# Soru 1a ----
# -------------------------------------------------------------------------- ###
https://github.com/batuhanerenler/istatistik_final

# -------------------------------------------------------------------------- ###
# Soru 2a ----
# -------------------------------------------------------------------------- ###
library(dplyr)

titanic %>%
  group_by(sex) %>%
  summarise(mean_fare = mean(fare, na.rm = TRUE))

# -------------------------------------------------------------------------- ###
# Soru 2b ----
# -------------------------------------------------------------------------- ###
library(ggplot2)

titanic %>%
  filter(!is.na(age)) %>%
  ggplot(aes(x = sex, y = age)) +
  geom_boxplot() +
  labs(x = "Cinsiyet", y = "Yaş", title = "Cinsiyete Göre Yaşların Kutu Grafiği")

# -------------------------------------------------------------------------- ###
# Soru 2c ----
# -------------------------------------------------------------------------- ###
library(ggplot2)

titanic %>%
  filter(!is.na(age)) %>%
  ggplot(aes(x = age)) +
  geom_histogram(binwidth = 2, fill = "blue", color = "black") +
  labs(x = "Yaş", y = "Yoğunluk", title = "Yaş Dağılımı Histogramı") +
  xlim(0, 80)

# -------------------------------------------------------------------------- ###
# Soru 3a ----
# -------------------------------------------------------------------------- ###

10 13
# -------------------------------------------------------------------------- ###
# Soru 3b ----
# -------------------------------------------------------------------------- ###

library(dplyr)

dat3 <- inner_join(dat1, dat2)
# -------------------------------------------------------------------------- ###
# Soru 3c ----
# -------------------------------------------------------------------------- ###

library(ggplot2)

# varsayılan veri setini oluşturuyoruz
dat <- tribble(
  ~a, ~b,
 
)

ggplot(dat, aes(x=a, y=b)) +
  geom_point() +
  labs(x="a", y="b") +
  theme_minimal()

# -------------------------------------------------------------------------- ###
# Soru 3d ----
# -------------------------------------------------------------------------- ###
c(2, 4)

# -------------------------------------------------------------------------- ###
# Soru 3e ----
# -------------------------------------------------------------------------- ###
pt(1, df = 24)

# -------------------------------------------------------------------------- ###
# Soru 3f ----
# -------------------------------------------------------------------------- ###
dice_roll <- function() {
  dice1 <- sample(1:6, 1)
  dice2 <- sample(1:6, 1)
  return(c(dice1, dice2))
}

# -------------------------------------------------------------------------- ###
# Soru 3g ----
# -------------------------------------------------------------------------- ###
titanic_survived <- titanic %>% filter(survived == 1) %>% pull(age)
titanic_not_survived <- titanic %>% filter(survived == 0) %>% pull(age)

t.test(titanic_survived, titanic_not_survived, var.equal = TRUE)

# -------------------------------------------------------------------------- ###
# Soru 4a ----
# -------------------------------------------------------------------------- ###

library(tidyverse)

dat <- tribble(
  ~country, ~`2018`, ~`2019`, ~`2020`,
  "Ingiltere", 8000, 8100, 8500,
  "Almanya", 10000, 11000, 10200
)

dat2 <- dat %>%
  pivot_longer(cols = `2018`:`2020`,
               names_to = "year",
               values_to = "gdp")

print(dat2)
# -------------------------------------------------------------------------- ###
# Soru 5a ----
# -------------------------------------------------------------------------- ###

library(ggplot2)

dat <- tribble(
  ~price, ~cut, ~depth, ~color,
  326, "Fair", 61.5, "E",
  326, "Good", 59.8, "E",
  327, "Very Good", 56.9, "E",
  334, "Premium", 62.4, "I",
  335, "Ideal", 63.3, "J"
)

ggplot(dat, aes(x=cut, y=price)) +
  geom_boxplot() +
  labs(x="Cut", y="Price") +
  theme_minimal()